this contains even more malloc code
